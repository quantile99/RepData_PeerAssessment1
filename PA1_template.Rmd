---
title: "Reproducible Research: Peer Assessment 1"
output: 
  html_document:
    keep_md: true
---


## Loading and preprocessing the data
```{r}
library(dplyr)
activity <- read.csv("activity.csv", stringsAsFactors = T)
```

## What is mean total number of steps taken per day?


### Calculate total number of steps taken per day
```{r}
steps_per_day <- 
    activity %>% 
    group_by(date) %>% 
    summarise_each(funs(sum), steps)
    
head(steps_per_day)
```

### Histogram of the total number of steps taken each day
```{r}
hist(steps_per_day$steps, breaks = 10)
```

### Mean and median total number of steps taken per day
```{r}
sumvals <-
steps_per_day %>% 
    filter(!is.na(steps)) %>%
    summarise_each(funs(mean, median), steps)
```

Mean total per day: 
```{r}
sumvals[[1]] 
```

Median total per day: 
```{r} 
sumvals[[2]] 
```


## What is the average daily activity pattern?

1. Make a time series plot (i.e. type = "l") of the 5-minute interval (x-axis) 
and the average number of steps taken, averaged across all days (y-axis)


Average over days
```{r}
avg_steps_per_interval <- 
    activity %>% 
    filter(!is.na(steps)) %>%
    group_by(interval) %>% 
    summarise_each(funs(mean), steps)

# Convert interval to date
avg_steps_per_interval <- 
    avg_steps_per_interval %>%
    mutate(hour =  sprintf("%02d", (interval %/% 100))  ,
              minute = sprintf("%02d", (interval %% 100))  ,
              timeStr = paste(hour, minute, sep = ":"))
    
avg_steps_per_interval$time <-          
    strptime(avg_steps_per_interval$timeStr, format = "%H:%M")

# Plot
with(avg_steps_per_interval,
    plot(time, steps, pch = "", type = "l"))
```

2. Which 5-minute interval, on average across all the days in the dataset, 
contains the maximum number of steps?

Time interval containg Maximum daily steps in hh:mm format:

```{r}
avg_steps_per_interval[avg_steps_per_interval$steps == max(avg_steps_per_interval$steps), 5][[1]]
```

## Imputing missing values



## Are there differences in activity patterns between weekdays and weekends?
